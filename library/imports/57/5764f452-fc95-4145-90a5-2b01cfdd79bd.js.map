{"version":3,"sources":["assets\\script\\game.js"],"names":["cc","Class","Component","properties","rope_node","type","Node","cow_ins","rope_imgs","SpriteFrame","cow_prefab","Prefab","onLoad","success","scoreNum","start","countDownLabel","find","getComponent","Label","time","schedule","string","log","resultNode","titleNode","getChildByName","contentNode","contentLabel","active","director","pause","clickCapture","event","customEventDate","setSiblingIndex","y","up","moveTo","x","result","callFunc","currentX","bgNode","node","removeChild","ropeType","randomType","Sprite","spriteFrame","instantiate","addChild","down","finish","scoreLabel","sequence","runAction","closeBtn","resume","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        rope_node:{\r\n            default : null,\r\n            type : cc.Node\r\n        },\r\n        cow_ins:{\r\n            default: null,\r\n            type:cc.Node\r\n        },\r\n        rope_imgs:{\r\n            default:[],\r\n            type:cc.SpriteFrame\r\n        },\r\n\r\n        //再绑定一个预制体\r\n        cow_prefab:{\r\n            default:null,\r\n            type:cc.Prefab\r\n        }\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.success=false;\r\n\r\n        //初始化分数\r\n        this.scoreNum=0;\r\n    },\r\n\r\n    start () {\r\n        let countDownLabel=cc.find(\"Canvas/bg-Sprite/count_down\").getComponent(cc.Label);\r\n        let time=30;\r\n        this.schedule(function(){\r\n            time--;\r\n            countDownLabel.string=time+\"s\";\r\n\r\n            if(time==0){\r\n                cc.log(\"游戏结束！\");\r\n                //获取弹窗节点\r\n                let resultNode=cc.find(\"Canvas/result\");\r\n                //获取title和content两个节点\r\n                let titleNode=resultNode.getChildByName(\"title\");\r\n                let contentNode=resultNode.getChildByName(\"content\");\r\n                //展示分数\r\n                titleNode.getComponent(cc.Label).string=\"最终得分：\"+this.scoreNum;\r\n\r\n                //获取组件\r\n                let contentLabel=contentNode.getComponent(cc.Label);\r\n                switch(true){\r\n                    case this.scoreNum<=3:\r\n                        contentLabel.string=\"套牛青铜\";\r\n                        break;\r\n                    case this.scoreNum<=6:\r\n                        contentLabel.string=\"套牛高手\";\r\n                        break;\r\n                    case this.scoreNum>6:\r\n                        contentLabel.string=\"套牛王者\";\r\n                        break;\r\n                }\r\n\r\n                resultNode.active=true;\r\n                cc.director.pause();\r\n            }\r\n        },1);\r\n\r\n        },\r\n\r\n    // update (dt) {},\r\n\r\n    //点击事件捕捉函数\r\n    clickCapture:function (event,customEventDate){\r\n        this.rope_node.active=true;\r\n        //设置绳子在当前父节点的顺序\r\n        this.rope_node.setSiblingIndex(100);\r\n\r\n        //设置绳子的起始位置\r\n        this.rope_node.y=-500;\r\n        //向上移动\r\n        const up=cc.moveTo(0.4,this.rope_node.x,0);\r\n\r\n\r\n        //判定结果\r\n        let result=cc.callFunc(function(){\r\n            //获取当前牛儿的x点\r\n            let currentX=this.cow_ins.x;\r\n            if(currentX>-80&&currentX<80){\r\n                cc.log(\"捕捉成功！\");\r\n\r\n                //移除\r\n                let bgNode = this.node.getChildByName(\"bg-Sprite\");\r\n                bgNode.removeChild(this.cow_ins);\r\n\r\n                //更换绳子,获取牛儿的类型\r\n                let ropeType=this.cow_ins.getComponent(\"cow\").randomType+1;\r\n                this.rope_node.getComponent(cc.Sprite).spriteFrame=this.rope_imgs[ropeType];\r\n\r\n\r\n                //生成新的牛节点\r\n                this.cow_ins=cc.instantiate(this.cow_prefab);\r\n                this.cow_ins.y=0;\r\n                bgNode.addChild(this.cow_ins);\r\n\r\n                this.success=true;\r\n                //分数加一\r\n                this.scoreNum++;\r\n            }\r\n            else{\r\n                cc.log(\"捕捉失败！\");\r\n            }\r\n        },this);\r\n\r\n        //往回拉\r\n        let down=cc.moveTo(0.5,this.rope_node.x,-500);\r\n\r\n        let finish=cc.callFunc(function (){\r\n            this.rope_node.getComponent(cc.Sprite).spriteFrame=this.rope_imgs[0];\r\n            //判断是否捕捉成功\r\n            if(this.success==true){\r\n                let scoreLabel=cc.find(\"Canvas/bg-Sprite/score\").getComponent(cc.Label);\r\n                scoreLabel.string=\"Score:\"+this.scoreNum;\r\n                this.success=false;\r\n            }\r\n        },this);\r\n\r\n\r\n\r\n        //定义一个序列动画\r\n        let sequence=cc.sequence(up,result,down,finish);\r\n\r\n        this.rope_node.runAction(sequence);\r\n    },\r\n\r\n    //关闭按钮，继续游戏\r\n    closeBtn(){\r\n        cc.log(\"继续游戏\");\r\n        cc.director.resume();//删除逻辑\r\n        cc.director.loadScene(\"game\");//重新加载\r\n    }\r\n\r\n});\r\n"]}